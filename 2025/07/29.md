## 取り組んだ課題一覧

- ポートフォリオ作成
    - コーディング
        - プロジェクトのセットアップ
        - ログイン機能機能実装

## わかったこと

## PHP（Laravel）Dockerで環境構築

### 実行コマンド

```bash
curl -s "https://laravel.build/smartfit-app?with=pgsql" | bash
```

- (前略)`laravel.build`/{任意プロジェクト名}?{with=使用するデータベース} | bash

### エラーが出ている時の対処法

https://blog.bug-fix.org/blog/91a73fd806

- 上記の記事に書いてあることを片っ端から試す。

### プロジェクトの実施（開発）

```bash
./vendor/bin/sail up -d
```

- sailのサーバを立ち上げる

```bash
./vendor/bin/sail npm install
./vendor/bin/sail npm run dev
```

- Vitaサーバの依存関係をインストール・サーバ起動

## pgAdminの設定

https://qiita.com/seito-deveoper/private/ba48a6b5af8637086156

- 上記の記事のことを一つずつやるとDB連携ができてデータベースの中身がGUIで確認できるようになる。

### もし、http://localhost:8888/にアクセスしてエラーになる場合

```bash
{"success":0,"errormsg":"'NoneType' object is not subscriptable","info":"","result":null,"data":null}
```

原因

- pgAdmin4の起動に失敗している
- 起動中のコンテナが異常

対処方法

- 起動中のコンテナを停止する

```bash
//Laravelsailコマンド
./vendor/bin/sail down

//dockerコマンド
./vendor/bin/sail down
```

- pgAdmin4の永続ボリュームを削除

```bash
docker volume rm $(docker volume ls -q | grep pgadmin4_data)
//Laravelsailのコマンドは無いのでdockerコマンド使用

//Dockerに存在するポリューム一覧をIDのみで表示させ、
//「pgadmin4_data」に一致するものだけを抽出し外部のコマンド(rm)に渡す
```

- コンテナを再度立ち上げる

```bash
//Laravelsailコマンド
./vendor/bin/sail up -d

//dockerコマンド
docker compose up -d --build

```

### コンテナ立ち上げる最中のエラー

```bash
ERROR [laravel.test  8/13] RUN groupadd --force -g sail

```

原因

- .envファイルに`WWWUSER`と`WWGROUT`未定義

対処方法

```bash
WWWUSER=1000
WWWGROUP=1000

//.envに上記を追加する。
//通常はホスト側ユーザーの UID/GID に合わせて 1000 が無難（macOS/Linux ならまず問題なし）
```

## 認証機能の追加

### Breezeパッケージを使って認証機能（ログイン・ログアウト）を追加する

```bash
composer require laravel/breeze --dev
```

- `composer`を使用してパッケージをダウンロードする

```bash
php artisan breeze:install
```

- Breezeをプロジェクトに適応（ファイル群を生成）
- 以下が生成される
    - 認証ルーティング
    - `resources/views/auth` に Blade テンプレート
    - `resources/js`, `resources/css` も使う構成（Vite）

```bash
npm install && npm run dev

```

- フロントエンド資産（JSやCSS）をインストール・ビルド

```bash
php artisan migrate
```

- マイグレーションでDBに必要なテーブルを作成

### もし、`composer`が使えない場合

```bash
which composer
//なにも表示されないなら以下を実行

//インストーラーをダウンロードしてインストーラーを実行する
php -r "copy('https://getcomposer.org/installer', 'composer-setup.php');"
php composer-setup.php

//グローバルで使えるように設定する
sudo mv composer.phar /usr/local/bin/composer

//動作確認
composer --version
//Composer version x.x.xが表示されると使えるようになる
```

## 次やること

- ページ作成(viesファイル)
- 新規登録機能
- パスワードリセット機能

## 感じたこと

- やっぱりコーディングは楽しい
- 考えて、仮説たててうまくいっても、いかなくても自分の思い通りになれば気持ちいい

## 学習時間

- 9h